[Environment]
device = default
master_port = random
world_size = auto
seed = 1
output_dir = ./outputs
torch_dtype = float32
use_libuv = 0
enable_autocast = False
autocast_dtype = bfloat16
enable_scaler = ${Environment:enable_autocast}

[Example]
name = SineGordonBVP
dim_x = 10000
method_soc = DfSocMartNet
method_pde = DfQuasiMartNet
method_evp = DfEvMartNet
repeat_time = 5
save_result_for_every_repeat_time = True
num_cost_path = ${Training:batsize}

[Network]
layer_norm = False
batch_norm = False
act_u = ReLU
act_v = Tanh
act_rho = ReLU
num_hidden_u = 4
num_hidden_v = 4
num_hidden_rho = 0
width_u = 128
width_v = 128
width_rho = 128
varscale = False
varscale_lb = 0.1
varscale_ub = 10.
multiscale_u = False
scale_step_u = 1.
num_subnets_u = 10
multiscale_v = False
scale_step_v = ${Network:scale_step_u}
num_subnets_v = ${Network:num_subnets_u}
multiscale_rho = ${Network:multiscale_u}
scale_step_rho = ${Network:scale_step_u}
num_subnets_rho = ${Network:num_subnets_u}
rho_shell = sin
scale_lb_rho = 1.
scale_ub_rho = 100.0

[Optimizer]
optimizer_u = Adam
optimizer_v = Adam
optimizer_lamb = Adam
optimizer_rho = Adam
lr0_u = 0.001
lr0_v = 0.001
lr0_rho = 0.001
lr0_lamb = 1e-2
kwargs_u = {}
kwargs_v = {}
kwargs_rho = {}
kwargs_lamb = {}
decay_stepgap_u = 100
decay_stepgap_v = 100
decay_stepgap_rho = 100
decay_stepgap_lamb = 100
decay_rate_u = 0.001**(${decay_stepgap_u} / ${Training:max_iter})
decay_rate_v = 0.001**(${decay_stepgap_v} / ${Training:max_iter})
decay_rate_rho = 0.001**(${decay_stepgap_rho} / ${Training:max_iter})
decay_rate_lamb = 1e-1**(${decay_stepgap_u} / ${Training:max_iter})

[Training]
max_iter = 5000
num_dt = 100
epochsize = 1000
batsize = 100
syspath_as_pilpath = True
rate_newpath = 0.2
inner_step_descend = 2
inner_step_ascend = 1

[RdmStrForm]
num_rdmsamp = 128
antithetic_variable = False

[BVP]
dt = 1.0 / ${Training:num_dt}

